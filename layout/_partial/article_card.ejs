<div class="relative bg-white dark:bg-slate-800 rounded-xl shadow-sm p-4 flex flex-col md:flex-row gap-4 hover:-translate-y-1 transition-transform group">
    <!-- 文章/project 相關顯示變數設定 -->
    <%
    var postLayout = post.layout || '';
    var project = postLayout === 'project' ? (config.theme_config?.projects_list ?? []).find(p => p.title === post.title) : null;
    var isProject = postLayout === 'project' && project;
    if (isProject) {
        var cover = project.image || theme.default_project_cover_image;
        var description = project.description || (post.excerpt || strip_html(post.content).substring(0, 100) + '...');
        if (project.tags && project.tags.length > 0) {
            // Convert tags to objects with name and path
            tags = [];
            project.tags.forEach(function(tag) {
                tags.push({ name: tag, path: '/tags/' + tag.replace(/\s+/g, '-').toLowerCase() + '/' });
            });
        }
    } else {
        var cover = post.cover_image || theme.default_article_cover_image;
        var description = post.excerpt || strip_html(post.content).substring(0, 100) + '...';
        var tags = post.tags || [];
    }
    %>
    <% if (postLayout === 'project') { %>
        <span class="absolute top-2 left-2 bg-indigo-600 text-white text-xs font-semibold px-2 py-1 rounded z-10">PROJECT</span>
    <% } %>
    <div class="w-full md:w-48 h-40 bg-slate-200 rounded-lg flex-shrink-0 bg-cover bg-center overflow-hidden">
        <a href="<%- url_for(post.path) %>" class="block w-full h-full bg-cover bg-center transition-transform duration-500 group-hover:scale-110" style="background-image: url('<%= cover %>');"></a>
    </div>
    <div class="flex flex-col justify-between flex-1 py-1">
        <div>
            <h3 class="font-bold text-xl mb-2 dark:text-white hover:text-primary dark:hover:text-indigo-400 transition-colors">
                <a href="<%- url_for(post.path) %>"><%= post.title %></a>
            </h3>
            <p class="text-slate-500 dark:text-slate-400 text-sm line-clamp-2">
                <%= description %>
            </p>
        </div>
        <div class="flex flex-wrap items-center gap-3 text-xs text-slate-400 mt-4 md:mt-0">
            <span class="flex items-center gap-1"><i class="far fa-calendar"></i> <%= date(post.date, 'YYYY-MM-DD') %></span>
            <% if(post.categories && post.categories.length){ %>
                <a href="<%- url_for(post.categories.data[0].path) %>" class="flex items-center gap-1 text-primary bg-indigo-50 dark:text-indigo-400 dark:bg-indigo-900/50 px-2 py-0.5 rounded hover:bg-indigo-100 dark:hover:bg-indigo-900/80">
                    <i class="fas fa-folder"></i> <%= post.categories.data[0].name %>
                </a>
            <% } %>
            <% if(isProject && project.links.demo) { %>
                <a href="<%= project.links.demo %>" target="_blank" class="flex items-center gap-1 text-primary hover:text-indigo-700 dark:text-primary-dark dark:hover:text-indigo-300 transition-colors">
                    <i class="fas fa-external-link-alt"></i> Live Demo
                </a>
            <% } %>
            <% if(tags && tags.length){ %>
                <div class="flex items-center gap-1">
                    <i class="fas fa-hashtag"></i>
                    <% tags.forEach(function(tag, index){ %>
                        <a href="<%- url_for(tag.path) %>" class=" hover:text-primary dark:hover:text-indigo-400 transition-colors">
                            <%= tag.name %>
                        </a>
                        <% if (index < tags.length - 1) { %>
                            ,
                        <% } %>
                    <% }); %>
                </div>
            <% } %>
        </div>
    </div>
</div>
